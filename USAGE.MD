# challenge-scala

## Running aplication

### Requirements

* Java installed and available on search path
* SBT 1.5.0 or higher installed and available on search path
* Git client installed and available on search path
* Cloned repository for this project:

```bash
git clone https://github.com/eltherion/challenge-scala.git
```

### Starting tests

To run tests navigate to cloned repository folder and execute execute:

```bash
cd /path/to/cloned/repository
sbt ";clean;coverage;test;it:test"
```

### Code test coverage

After running tests code coverage reports can be generated by executing command:

```bash
sbt "coverageReport"
```

Reports can be conveniently viewed in any browser by navigating to URL `/path/to/cloned/repository/target/scala-2.13/scoverage-report/index.html`

Minimum coverage is set to 80%.

### Starting application

Navigate to cloned repository folder:

```bash
cd /path/to/cloned/repository
```

Then execute:

```bash
sbt run
```

### Sending requests

Http server is available at http://127.0.0.1:8080/

#### Create task
```bash
curl 'http://localhost:8080/task' \
 -H 'Content-Type: application/json' \
 --data-raw '{"uri":"https://www.stats.govt.nz/assets/Uploads/International-migration/International-migration-December-2020/Download-data/international-migration-December-2020-citizenship-by-visa-by-country-of-last-permanent-residence.csv"}'
```
Id of a task is an UUID.

#### List tasks
```bash
curl 'http://localhost:8080/task'
```

#### Task detail

Use websocket client (for example: wscat):
```bash
wscat --connect ws://localhost:8080/task/337b1fb8-db2f-483b-ba1a-379b4d2a1df4
```

#### Cancel task
```bash
curl  -X DELETE \
 'http://localhost:8080/task/dd39cf9f-f91d-4948-818f-7f4b535efd3e' 
```

### Get JSON file
```bash
curl 'http://localhost:8080/file/180831cd-49f3-4eab-92ce-bdfe7a55f338'
```